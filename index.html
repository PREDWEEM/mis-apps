# ================================================================
# üåæ PREDWEEM ‚Äî Landing Page compatible con Streamlit
# Versi√≥n profesional basada en tu HTML original
# ================================================================

import streamlit as st
from pathlib import Path

# ---------------------------------------------------------------
# CONFIGURACI√ìN DE P√ÅGINA
# ---------------------------------------------------------------
st.set_page_config(
    page_title="PREDWEEM ‚Äì Predictive Weed Emergence Models",
    layout="wide",
)

# ---------------------------------------------------------------
# CSS (adaptado de tu HTML original)
# ---------------------------------------------------------------
st.markdown("""
<style>
:root{
  --bg:#f8f9f4; --card:#ffffff; --text:#243024; --muted:#5b6b5b;
  --primary:#2e5e2d; --accent:#4CAF50; --border:#e0e6db; --link:#1e6fe0;
}
html, body, .stApp {
  background: var(--bg);
  font-family: Inter, sans-serif;
  color: var(--text);
}
h1, h2, h3 { color: var(--primary); }
.card {
  background: var(--card);
  border:1px solid var(--border);
  padding:18px;
  border-radius:16px;
}
.btn {
  display:inline-block;
  background:var(--accent);
  padding:10px 14px;
  border-radius:12px;
  color:white !important;
  text-decoration:none;
  font-weight:600;
}
.btn-secondary {
  background:#2e5e2d !important;
}
.model-img {
  width:100%;
  border-radius:12px;
  margin-bottom:8px;
}
footer {
  text-align:center;
  margin-top:32px;
  padding-top:16px;
  border-top:1px solid var(--border);
  color:var(--muted);
}
</style>
""", unsafe_allow_html=True)


# ---------------------------------------------------------------
# SELECTOR DE IDIOMA (STATEFUL)
# ---------------------------------------------------------------
if "lang" not in st.session_state:
    st.session_state.lang = "es" if st.session_state.get("preferred_lang", "es") == "es" else "en"

colA, colB = st.columns([1, 8])
with colA:
    if st.button("ES üá¶üá∑"):
        st.session_state.lang = "es"
    if st.button("EN üá∫üá∏"):
        st.session_state.lang = "en"

LANG = st.session_state.lang


# ================================================================
# üß© DICCIONARIO DE TRADUCCI√ìN
# ================================================================
T = {
    "es": {
        "title": "üìä PREDWEEM ‚Äì Modelos Predictivos de Emergencia de Malezas",
        "subtitle": "Herramientas para la gesti√≥n sustentable en la regi√≥n pampeana",
        "intro": """Este portal re√∫ne modelos de emergencia desarrollados por la UNS y el INTA.
Use datos meteorol√≥gicos provistos autom√°ticamente o cargue datos propios para obtener
emergencia diaria y emergencia acumulada 2025.""",
        "models": "Modelos",
        "guide": "Gu√≠a de uso",
        "team": "Desarrollador y colaboradores",
        "inst": "Instituciones colaboradoras",
        "contact": "Consultas o comentarios",
    },
    "en": {
        "title": "üìä PREDWEEM ‚Äì Predictive Weed Emergence Models",
        "subtitle": "Decision tools for sustainable management in the Pampas region",
        "intro": """This portal contains weed emergence models developed jointly by UNS and INTA.
Upload weather data to obtain daily relative emergence and cumulative emergence 2025.""",
        "models": "Models",
        "guide": "User guide",
        "team": "Developer & contributors",
        "inst": "Collaborating institutions",
        "contact": "Inquiries or comments",
    }
}

tr = lambda k: T[LANG][k]


# ================================================================
# üîù PORTADA
# ================================================================
st.markdown(f"""
# {tr("title")}
### {tr("subtitle")}
""")

st.write(tr("intro"))

st.image("austral.png", width=500)


# ================================================================
# üß† MODELOS
# ================================================================
st.markdown(f"## {tr('models')}")

cols = st.columns(3)

models = [
    ("Lolium sp. BORDENAVE‚Äì2025", "lolium.jpeg",
     "https://appemergenciapy-lscuxqt2j3sa9yjrwgyqnh.streamlit.app/?embed=true"),
    ("Lolium sp. TRES ARROYOS‚Äì2025", "lolium.jpeg",
     "https://appemergenciapy-pfj3sr8shtoqcucopfmkat.streamlit.app/?embed=true"),
    ("Avena fatua BORDENAVE‚Äì2025", "AVEFA.jpg",
     "https://appemergenciapy-mp6o4yjxbxctoekktcradc.streamlit.app/?embed=true"),
    ("Hirshfeldia incana BORDENAVE‚Äì2025", "hirsin.png",
     "https://u2tod53cwpaeqmlqpmp2of.streamlit.app/?embed=true"),
    ("Euphorbia davidii BORDENAVE‚Äì2025", "EUPHO.jpg",
     "https://appemergenciaapppy-gfda7txzhpsf2ahkcmv7h5.streamlit.app/?embed=true"),
    ("Euphorbia davidii BAH√çA BLANCA‚Äì2025", "EUPHO.jpg",
     "https://appemergenciaapppy-ah6c82sgacq2d7z2i5uptl.streamlit.app/?embed=true"),
    ("Euphorbia davidii OLAVARR√çA‚Äì2025", "EUPHO.jpg",
     "https://appemergenciaapppy-v3dns5cft6ws9p9jdhzepj.streamlit.app/?embed=true"),
]

# Render din√°mico en grilla
for i, (name, img, link) in enumerate(models):
    with cols[i % 3]:
        st.markdown('<div class="card">', unsafe_allow_html=True)
        st.image(img, use_column_width=True)
        st.markdown(f"**{name}**")
        st.markdown(f'<a class="btn" href="{link}" target="_blank">Abrir app</a>',
                    unsafe_allow_html=True)
        st.markdown('</div>', unsafe_allow_html=True)


# ================================================================
# üìò GU√çA DE USO
# ================================================================
st.markdown(f"## {tr('guide')}")

st.markdown("""
### 1Ô∏è‚É£ Cargar datos meteorol√≥gicos
- Formato: Excel (.xlsx)  
- Columnas exactas: **Julian_days, TMAX, TMIN, Prec**

### 2Ô∏è‚É£ Visualizar resultados
- EMERREL diaria  
- EMERAC acumulada  
- Fecha calendario + JD

### 3Ô∏è‚É£ Descargar resultados
- CSV con EMERREL y EMERAC
""")

st.image("pipa.png", width=450)
st.image("ac.png", width=450)


# ================================================================
# üéØ EQUIPO
# ================================================================
st.markdown(f"## {tr('team')}")

c1, c2, c3, c4, c5 = st.columns(5)

c1.image("FOTO.jpg", caption="Ing. Agr. (Dr.) G. R. Chantre")
c2.image("Luis.JPG", caption="Ing. Agr. (Dr.) Luis M. Carretto")
c3.image("ramon.jpeg", caption="Ing. Agr. Ram√≥n Gigon")
c4.image("mario.jpeg", caption="Ing. Agr. Mario R. Vigna")
c5.image("fede.jpg", caption="Ing. Agr. Federico N√∫√±ez-Fr√©")


# ================================================================
# üèõ INSTITUCIONES
# ================================================================
st.markdown(f"## {tr('inst')}")

c1, c2, c3, c4 = st.columns(4)
c1.image("descarga.jpg")
c2.image("cerzos.jpg")
c3.image("inta.png")
c4.image("BCP_3-100.jpg")


# ================================================================
# üì© CONTACTO (FORMULARIO STREAMLIT)
# ================================================================
st.markdown(f"## {tr('contact')}")

with st.form("contact_form"):
    name = st.text_input("Nombre:")
    email = st.text_input("Correo:")
    topic = st.selectbox("Motivo:", ["Soporte", "Sugerencia", "Error/Bug", "Colaboraci√≥n", "Otro"])
    msg = st.text_area("Mensaje:")

    submitted = st.form_submit_button("Enviar")
    if submitted:
        st.success("Mensaje enviado. ¬°Gracias!")


# ================================================================
# FOOTER
# ================================================================
st.markdown("""
<footer>
¬© 2025 Guillermo R. Chantre ¬∑ PREDWEEM. All rights reserved.
</footer>
""", unsafe_allow_html=True)
