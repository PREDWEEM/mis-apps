<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PREDWEEM ¬∑ Predictive Weed Emergence Models</title>
  <meta name="description" content="Portal for daily weed emergence risk and cumulative emergence models (ANN) developed by UNS & INTA." />
  <meta property="og:title" content="PREDWEEM ‚Äì Predictive Weed Emergence Models" />
  <meta property="og:description" content="Decision tools for sustainable management in the Pampas region. Use automatically provided meteorological data or Upload your weather data and get 2025 forecasts." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="austral.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-KJL1YNPYYS"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-KJL1YNPYYS');
  </script>
  <style>
    :root{
      --bg:#f8f9f4; --card:#ffffff; --text:#243024; --muted:#5b6b5b;
      --primary:#2e5e2d; --accent:#4CAF50; --border:#e0e6db; --link:#1e6fe0;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Arial,"Segoe UI",sans-serif;line-height:1.55}
    img{max-width:100%;height:auto;border-radius:12px}
    a{color:var(--link);text-decoration:none}
    a:hover{text-decoration:underline}
    .container{max-width:1100px;margin:0 auto;padding:24px}
    header{display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:18px}
    .brand{display:flex;gap:14px;align-items:center}
    .logo{width:64px;height:64px;border-radius:14px;background:linear-gradient(135deg,#2e5e2d,#6fbf73)}
    h1{font-size:28px;color:var(--primary);margin:0}
    .subtitle{margin:4px 0 0 0;color:var(--muted)}
    .lang{display:flex;gap:8px;align-items:center}
    .lang button{border:1px solid var(--border);background:#fff;border-radius:999px;padding:6px 10px;cursor:pointer}
    .lang button.active{background:var(--primary);color:#fff;border-color:var(--primary)}
    .hero{display:grid;grid-template-columns:1.1fr .9fr;gap:18px;align-items:center;margin:10px 0 22px}
    .hero .cta{display:flex;gap:12px;flex-wrap:wrap;margin-top:10px}
    .btn{display:inline-block;background:var(--accent);color:#fff;border:none;border-radius:12px;padding:10px 14px;font-weight:600;cursor:pointer}
    .btn.secondary{background:#2e5e2d}
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .grid-4{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
    .section{margin:18px 0}
    .section h2{color:var(--primary);margin:0 0 8px}
    .muted{color:var(--muted)}
    .model-card{display:flex;flex-direction:column;gap:10px}
    .model-card img{aspect-ratio:16/9;object-fit:cover}
    .model-card .title{font-weight:700}
    .steps{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .step{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:14px}
    .step h3{margin:0 0 6px;color:var(--primary);font-size:16px}
    .kbd{font-family:ui-monospace, Menlo, monospace;background:#eef1ea;border:1px solid var(--border);border-radius:8px;padding:0 6px}
    .legend{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .dot{width:10px;height:10px;border-radius:50%}
    .dot.green{background:#2ecc71}.dot.orange{background:#f0932b}.dot.red{background:#d33535}
    .tbl{width:100%;border-collapse:separate;border-spacing:0 8px}
    .tbl th{font-size:13px;color:var(--muted);text-align:left}
    footer{margin-top:26px;padding-top:16px;border-top:1px solid var(--border);color:var(--muted)}
    @media (max-width:960px){.grid{grid-template-columns:1fr}.grid-2,.grid-4{grid-template-columns:1fr}.hero{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1 data-i18n="title">üìä PREDWEEM ‚Äì Predictive Weed Emergence Models</h1>
          <p class="subtitle" data-i18n="subtitle">Decision tools for sustainable management in the Pampas region</p>
        </div>
      </div>
      <div class="lang" aria-label="Language selector">
        <button id="btn-es">ES</button>
        <button id="btn-en" class="active">EN</button>
      </div>
    </header>

    <section class="hero">
      <div class="card">
        <p data-i18n="hero_text">
          This portal contains weed emergence models developed collaboratively by the Department of Agronomy (Universidad Nacional del Sur) and INTA.
          Use automatically provided meteorological data from the area or Upload your site-specific weather data and get daily risk levels and cumulative emergence (%) for <strong>2025</strong>.
        </p>
        <div class="cta">
          <a class="btn" href="#models" data-i18n="cta_models">Explore models</a>
          <a class="btn secondary" href="#guide" data-i18n="cta_guide">User guide</a>
          <a class="btn" href="plantilla_predweem.xlsx" download data-i18n="cta_template">Download Excel template</a>
        </div>
      </div>
      <figure>
        <img src="austral.png" alt="Austral Pampas map" />
      </figure>
    </section>

    <section id="models" class="section">
      <h2 data-i18n="models_h2">Models</h2>
      <div class="grid">
        <article class="card model-card">
          <img src="lolium.jpeg" alt="Lolium spp." />
          <div class="title" data-i18n="model1_title">üß† Lolium sp. BORDENAVE‚Äì2025 </div>
          <a class="btn" target="_blank" href="https://appemergenciapy-lscuxqt2j3sa9yjrwgyqnh.streamlit.app/?embed=true" data-i18n="open_app">Open app</a>
        </article>
        <article class="card model-card">
          <img src="lolium.jpeg" alt="Lolium spp." />
          <div class="title" data-i18n="model2_title">üß† Lolium sp. TRES ARROYOS‚Äì2025 </div>
          <a class="btn" target="_blank" href="https://appemergenciapy-pfj3sr8shtoqcucopfmkat.streamlit.app/?embed=true" data-i18n="open_app">Open app</a>
        </article>
        <article class="card model-card">
          <img src="AVEFA.jpg" alt="AVEFA" />
          <div class="title" data-i18n="model3_title">üß† Avena fatua BORDENAVE‚Äì2025 </div>
          <a class="btn" target="_blank" href="https://appemergenciapy-mp6o4yjxbxctoekktcradc.streamlit.app/?embed=true" data-i18n="open_app">Open app</a>
        </article>
        <article class="card model-card">
          <img src="hirsin.png" alt="Hirshfeldia incana (Bordenave)" />
          <div class="title" data-i18n="model4_title">üß† Hirshfeldia incana BORDENAVE‚Äì2025 </div>
          <a class="btn" target="_blank" href="https://u2tod53cwpaeqmlqpmp2of.streamlit.app/?embed=true" data-i18n="open_app">Open app</a>
        </article>
        <article class="card model-card">
          <img src="EUPHO.jpg" alt="Euphorbia davidii" />
          <div class="title" data-i18n="model5_title">üß† Euphorbia davidii BORDENAVE-2025</div>
          <a class="btn" target="_blank" href="https://appemergenciaapppy-gfda7txzhpsf2ahkcmv7h5.streamlit.app/?embed=true" data-i18n="open_app">Open app</a>
        </article>
        <article class="card model-card">
          <img src="EUPHO.jpg" alt="Euphorbia davidii" />
          <div class="title" data-i18n="model6_title">üß† Euphorbia davidii BAHIA BLANCA-2025</div>
          <a class="btn" target="_blank" href="https://appemergenciaapppy-ah6c82sgacq2d7z2i5uptl.streamlit.app/?embed=true" data-i18n="open_app">Open app</a>
        </article>
         <article class="card model-card">
          <img src="EUPHO.jpg" alt="Euphorbia davidii" />
          <div class="title" data-i18n="model7_title">üß† Euphorbia davidii OLAVARRIA-2025</div>
          <a class="btn" target="_blank" href="https://appemergenciaapppy-v3dns5cft6ws9p9jdhzepj.streamlit.app/?embed=true" data-i18n="open_app">Open app</a>
        </article>
      </div>
    </section>

    <section id="overview" class="section">
      <h2 data-i18n="overview_h2">System overview</h2>
      <div class="grid-2">
        <div class="card">
          <p data-i18n="overview_p1">
            The system is a Python application built with Streamlit. It predicts <strong>daily weed emergence levels</strong>
            and <strong>cumulative emergence percentages</strong> using an <abbr title="Artificial Neural Network">ANN</abbr>
            trained on historical meteorological data.
          </p>
          <p class="muted" data-i18n="overview_p2"> Developed by Guillermo R. Chantre (Universidad Nacional del Sur ¬∑ CERZOS) </p>
        </div>
        <figure>
          <img src="monitoreo emergencia.jpg" alt="Field monitoring" />
        </figure>
      </div>
    </section>

    <section id="guide" class="section">
      <h2 data-i18n="guide_h2">User guide ¬∑ Field Emergence Forecast 2025</h2>
      <div class="steps">
        <div class="step">
          <h3 data-i18n="g1_h3">1Ô∏è‚É£ Upload your weather data</h3>
          <p data-i18n="g1_p1">Required format: Excel (.xlsx) with exact column names:</p>
          <p><span class="kbd">Julian_days</span> ¬∑ <span class="kbd">TMAX</span> ¬∑ <span class="kbd">TMIN</span> ¬∑ <span class="kbd">Prec</span></p>
          <p class="muted" data-i18n="g1_p2">Use the file upload button in the app.</p>
        </div>
        <div class="step">
          <h3 data-i18n="g2_h3">2Ô∏è‚É£ View results</h3>
          <p data-i18n="g2_p1">Daily Relative Emergence bar chart and cumulative emergence (%) over time.</p>
          <div class="legend"><span class="dot green"></span><span data-i18n="legend_low">Low</span> <span class="dot orange"></span><span data-i18n="legend_med">Medium</span> <span class="dot red"></span><span data-i18n="legend_high">High</span></div>
        </div>
        <div class="step">
          <h3 data-i18n="g3_h3">3Ô∏è‚É£ Download</h3>
          <p data-i18n="g3_p1">Results include Julian day, calendar date, daily level and cumulative emergence (%). Export as CSV.</p>
        </div>
      </div>
      <div class="grid-2" style="margin-top:14px">
        <figure class="card"><img src="pipa.png" alt="Daily emergence chart" /></figure>
        <figure class="card"><img src="ac.png" alt="Cumulative emergence chart" /></figure>
      </div>
    </section>

    <section id="faq" class="section">
      <h2 data-i18n="faq_h2">FAQ</h2>
      <div class="grid-2">
        <div class="card">
          <h3 data-i18n="faq_q1">What if my file has different column names?</h3>
          <p data-i18n="faq_a1">Rename columns exactly to Julian_days, TMAX, TMIN, Prec. You can start from the downloadable template.</p>
        </div>
        <div class="card">
          <h3 data-i18n="faq_q2">What year are predictions valid for?</h3>
          <p data-i18n="faq_a2">Models are calibrated for 2025 in this release. Future versions may include other years.</p>
        </div>
        <div class="card">
          <h3 data-i18n="faq_q3">Can I use data with missing days?</h3>
          <p data-i18n="faq_a3">Yes, but filling gaps improves accuracy. Keep Julian_days continuous where possible.</p>
        </div>
        <div class="card">
          <h3 data-i18n="faq_q4">Where is my data stored?</h3>
          <p data-i18n="faq_a4">Data is processed client-side by Streamlit Cloud; files aren‚Äôt persisted after your session ends.</p>
        </div>
      </div>
    </section>

    <section id="team" class="section">
      <h2 data-i18n="team_h2">Developer & contributors</h2>
      <div class="grid-4">
        <figure class="card">
          <img src="FOTO.jpg" alt="Guillermo R. Chantre" />
          <figcaption><strong>Ing. Agr. (Dr.) Guillermo R. Chantre</strong><br/>Dept. of Agronomy, UNS ¬∑ Bah√≠a Blanca, AR<br/><a href="mailto:guillermo.chantre@uns.edu.ar">guillermo.chantre@uns.edu.ar</a></figcaption>
        </figure>
        <figure class="card">
          <img src="Luis.JPG" alt="Luis M. Carretto" />
          <figcaption><strong>Ing. Agr. (Dr.) Luis M. Carretto</strong><br/>EEA INTA Bordenave ¬∑ Puan (Bs. As.)</figcaption>
        </figure>
        <figure class="card">
          <img src="ramon.jpeg" alt="Ram√≥n Gigon" />
          <figcaption><strong>Ing. Agr. (MSc.) Ram√≥n Gigon</strong><br/>Director RG malezas ¬∑ Tres Arroyos</figcaption>
        </figure>
        <figure class="card">
          <img src="mario.jpeg" alt="Mario R. Vigna" />
          <figcaption><strong>Ing. Agr. (MSc.) Mario R. Vigna</strong><br/>Ex-INTA ¬∑ CIC ¬∑ CONICET ¬∑ Private advisor</figcaption>
        </figure>
        <figure class="card">
          <img src="fede.jpg" alt="fede" />
          <figcaption><strong>Ing. Agr. (MSc.) Federico Nu√±ez-Fr√© </strong><br/> Investigador/ Jefe de Trabajos Pr√°cticos UNICEN </figcaption>
        </figure>
      </div>
    </section>

    <section id="institutions" class="section">
      <h2 data-i18n="inst_h2">Collaborating institutions</h2>
      <div class="grid-4">
        <figure class="card"><img src="descarga.jpg" alt="UNS" /></figure>
        <figure class="card"><img src="cerzos.jpg" alt="CERZOS" /></figure>
        <figure class="card"><img src="inta.png" alt="INTA" /></figure>
        <figure class="card"><img src="BCP_3-100.jpg" alt="BCP" /></figure>
      </div>
    </section>

    <!-- Contact section -->
    <section id="contact" class="section">
      <h2 data-i18n="contact_h2">Consultas o comentarios</h2>
      <div class="card">
        <form id="contact-form" action="https://formspree.io/f/mkgzyvbg" method="POST" enctype="multipart/form-data">
          <!-- Honeypot anti-spam -->
          <input type="text" name="_gotcha" style="display:none">
          <!-- Asunto din√°mico -->
          <input type="hidden" name="_subject" id="subject" value="Consulta desde PREDWEEM">

          <label for="topic" data-i18n="contact_topic">Motivo:</label><br>
          <select id="topic" name="topic" required
            style="width:100%;padding:8px;margin:6px 0;border:1px solid var(--border);border-radius:8px;">
            <option value="" selected disabled data-i18n="contact_topic_placeholder">Seleccion√° un motivo‚Ä¶</option>
            <option value="Soporte" data-i18n="contact_topic_support">Soporte</option>
            <option value="Sugerencia" data-i18n="contact_topic_suggestion">Sugerencia</option>
            <option value="Error/Bug" data-i18n="contact_topic_bug">Error/Bug</option>
            <option value="Colaboraci√≥n" data-i18n="contact_topic_collab">Colaboraci√≥n</option>
            <option value="Otro" data-i18n="contact_topic_other">Otro</option>
          </select><br>

          <label for="name" data-i18n="contact_name">Nombre:</label><br>
          <input type="text" id="name" name="name" required
            style="width:100%;padding:8px;margin:6px 0;border:1px solid var(--border);border-radius:8px;"><br>

          <label for="email" data-i18n="contact_email">Correo electr√≥nico:</label><br>
          <input type="email" id="email" name="_replyto" required
            style="width:100%;padding:8px;margin:6px 0;border:1px solid var(--border);border-radius:8px;"><br>

          <label for="message" data-i18n="contact_message">Mensaje:</label><br>
          <textarea id="message" name="message" rows="4" required
            style="width:100%;padding:8px;margin:6px 0;border:1px solid var(--border);border-radius:8px;"></textarea><br>

          <label for="file" data-i18n="contact_file">Adjuntar archivo (opcional):</label><br>
          <input type="file" id="file" name="file"
            style="width:100%;padding:8px;margin:6px 0;border:1px solid var(--border);border-radius:8px;"
            accept=".png,.jpg,.jpeg,.pdf,.xlsx,.csv,.txt"><br>
          <small class="muted" data-i18n="contact_file_hint">Formatos: PNG, JPG, PDF, XLSX, CSV, TXT. M√°x. 5 MB.</small><br><br>

          <button type="submit" class="btn" data-i18n="contact_send">Enviar</button>
          <p id="form-status" class="muted" aria-live="polite" style="margin-top:8px;"></p>
        </form>
      </div>
    </section>

    <footer>
      <small data-i18n="footer">¬© 2025 Guillermo R. Chantre ¬∑ PREDWEEM. All rights reserved.</small>
    </footer>
  </div>

  <script>
    // Simple i18n: dictionary-based toggle
    const dict = {
      es: {
        title: 'üìä PREDWEEM ‚Äì Modelos Predictivos de Emergencia de Malezas',
        subtitle: 'Herramientas para la gesti√≥n sustentable en la regi√≥n pampeana',
        hero_text: 'Este portal re√∫ne modelos de emergencia desarrollados por el Departamento de Agronom√≠a (Universidad Nacional del Sur) y el INTA. Use datos meteorol√≥gicos provistos automaticamente o Cargue sus datos meteorol√≥gicos sitio-especificos y obtenga niveles diarios de riesgo y emergencia acumulada (%) para <strong>2025</strong>.',
        cta_models: 'Ver modelos',
        cta_guide: 'Gu√≠a de uso',
        cta_template: 'Descargar plantilla Excel',
        models_h2: 'Modelos',
        model1_title: 'üß† Lolium sp. BORDENAVE‚Äì2025',
        model2_title: 'üß† Lolium sp. TRES ARROYOS‚Äì2025',
        model3_title: 'üß† Avena fatua BORDENAVE‚Äì2025',
        model4_title: 'üß† Hirshfeldia incana BORDENAVE‚Äì2025',
        model5_title: 'üß† Euphorbia davidii BORDENAVE-2025',
        model6_title: 'üß† Euphorbia davidii BAHIA BLANCA-2025',
        model7_title: 'üß† Euphorbia davidii OLAVARRIA-2025',
        open_app: 'Abrir app',
        overview_h2: 'Descripci√≥n del sistema',
        overview_p1: 'El sistema es una aplicaci√≥n en Python con Streamlit. Predice <strong>niveles diarios de emergencia</strong> y <strong>porcentaje acumulado (EMEAC)</strong> mediante una Red Neuronal Artificial entrenada con datos meteorol√≥gicos hist√≥ricos.',
        overview_p2: 'Developed by Guillermo R. Chantre (Universidad Nacional del Sur ¬∑ CERZOS) ',
        guide_h2: 'Gu√≠a de uso ¬∑ Pron√≥stico de emergencia 2025',
        g1_h3: '1Ô∏è‚É£ Cargue sus datos meteorol√≥gicos',
        g1_p1: 'Formato requerido: Excel (.xlsx) con nombres de columna exactos:',
        g1_p2: 'Use el bot√≥n de carga dentro de la app.',
        g2_h3: '2Ô∏è‚É£ Visualice los resultados',
        g2_p1: 'Gr√°fico de barras de Emergencia Relativa diaria y Emergencia Acumulada (%) en el tiempo.',
        legend_low: 'Bajo', legend_med: 'Medio', legend_high: 'Alto',
        g3_h3: '3Ô∏è‚É£ Descargue',
        g3_p1: 'Resultados incluyen d√≠a juliano, fecha calendario, nivel diario y emergencia acumulada (%). Exporta a CSV.',
        faq_h2: 'Preguntas frecuentes',
        faq_q1: '¬øQu√© pasa si mi archivo tiene otros nombres de columnas?',
        faq_a1: 'Ren√≥mbrelas exactamente a Julian_days, TMAX, TMIN, Prec. Puede iniciar desde la plantilla descargable.',
        faq_q2: '¬øPara qu√© a√±o son v√°lidas las predicciones?',
        faq_a2: 'En esta versi√≥n est√°n calibradas para 2025. Versiones futuras pueden incluir otros a√±os.',
        faq_q3: '¬øPuedo usar datos con d√≠as faltantes?',
        faq_a3: 'S√≠, pero completar huecos mejora la precisi√≥n. Mantenga Julian_days continuo cuando sea posible.',
        faq_q4: '¬øD√≥nde se almacenan mis datos?',
        faq_a4: 'Los datos se procesan en Streamlit Cloud y no se persisten luego de su sesi√≥n.',
        team_h2: 'Desarrollador y colaboradores',
        inst_h2: 'Instituciones colaboradoras',
        footer: '¬© 2025 Guillermo R. Chantre ¬∑ PREDWEEM. Todos los derechos reservados.',

        // Contacto
        contact_h2: 'Consultas o comentarios',
        contact_name: 'Nombre:',
        contact_email: 'Correo electr√≥nico:',
        contact_message: 'Mensaje:',
        contact_send: 'Enviar',
        contact_sending: 'Enviando‚Ä¶',
        contact_success: '¬°Gracias! Tu mensaje fue enviado.',
        contact_error: 'Ocurri√≥ un error. Por favor, prob√° de nuevo m√°s tarde.',
        contact_topic: 'Motivo:',
        contact_topic_placeholder: 'Seleccion√° un motivo‚Ä¶',
        contact_topic_support: 'Soporte',
        contact_topic_suggestion: 'Sugerencia',
        contact_topic_bug: 'Error/Bug',
        contact_topic_collab: 'Colaboraci√≥n',
        contact_topic_other: 'Otro',
        contact_file: 'Adjuntar archivo (opcional):',
        contact_file_hint: 'Formatos: PNG, JPG, PDF, XLSX, CSV, TXT. M√°x. 5 MB.',
        contact_file_type: 'Tipo de archivo no permitido.',
        contact_file_size: 'El archivo supera el tama√±o m√°ximo permitido (5 MB).'
      },
      en: {
        title: 'üìä PREDWEEM ‚Äì Predictive Weed Emergence Models',
        subtitle: 'Decision tools for sustainable management in the Pampas region',
        hero_text: 'This portal contains weed emergence models developed collaboratively by the Department of Agronomy (Universidad Nacional del Sur) and INTA. Use automatically provided meteorological data or Upload your site-specific weather data and get daily risk levels and cumulative emergence (%) for <strong>2025</strong>.',
        cta_models: 'Explore models',
        cta_guide: 'User guide',
        cta_template: 'Download Excel template',
        models_h2: 'Models',
        model1_title: 'üß† Lolium sp. BORDENAVE‚Äì2025',
        model2_title: 'üß† Lolium sp. TRES ARROYOS‚Äì2025',
        model3_title: 'üß† Avena fatua BORDENAVE‚Äì2025',
        model4_title: 'üß† Hirshfeldia incana BORDENAVE‚Äì2025',
        model5_title: 'üß† Euphorbia davidii NAPOSTA-2025',
        model6_title: 'üß† Euphorbia davidii BORDENAVE-2025',
        open_app: 'Open app',
        overview_h2: 'System overview',
        overview_p1: 'The system is a Python application built with Streamlit. It predicts <strong>daily weed emergence levels</strong> and <strong>cumulative emergence percentages</strong> using an Artificial Neural Network trained on historical meteorological data.',
        overview_p2: 'Developed by Guillermo R. Chantre (Universidad Nacional del Sur ¬∑ CERZOS)',
        guide_h2: 'User guide ¬∑ Field Emergence Forecast 2025',
        g1_h3: '1Ô∏è‚É£ Upload your weather data',
        g1_p1: 'Required format: Excel (.xlsx) with exact column names:',
        g1_p2: 'Use the file upload button in the app.',
        g2_h3: '2Ô∏è‚É£ View results',
        g2_p1: 'Daily Relative Emergence bar chart and cumulative emergence (%) over time.',
        legend_low: 'Low', legend_med: 'Medium', legend_high: 'High',
        g3_h3: '3Ô∏è‚É£ Download',
        g3_p1: 'Results include Julian day, calendar date, daily level and cumulative emergence (%). Export as CSV.',
        faq_h2: 'FAQ',
        faq_q1: 'What if my file has different column names?',
        faq_a1: 'Rename columns exactly to Julian_days, TMAX, TMIN, Prec. You can start from the downloadable template.',
        faq_q2: 'What year are predictions valid for?',
        faq_a2: 'Models are calibrated for 2025 in this release. Future versions may include other years.',
        faq_q3: 'Can I use data with missing days?',
        faq_a3: 'Yes, but filling gaps improves accuracy. Keep Julian_days continuous where possible.',
        faq_q4: 'Where is my data stored?',
        faq_a4: 'Data is processed client-side by Streamlit Cloud; files aren‚Äôt persisted after your session ends.',
        team_h2: 'Developer & contributors',
        inst_h2: 'Collaborating institutions',
        footer: '¬© 2025 Guillermo R. Chantre ¬∑ PREDWEEM. All rights reserved.',

        // Contact
        contact_h2: 'Inquiries or comments',
        contact_name: 'Name:',
        contact_email: 'Email:',
        contact_message: 'Message:',
        contact_send: 'Send',
        contact_sending: 'Sending‚Ä¶',
        contact_success: 'Thanks! Your message has been sent.',
        contact_error: 'Something went wrong. Please try again later.',
        contact_topic: 'Topic:',
        contact_topic_placeholder: 'Select a topic‚Ä¶',
        contact_topic_support: 'Support',
        contact_topic_suggestion: 'Suggestion',
        contact_topic_bug: 'Bug',
        contact_topic_collab: 'Collaboration',
        contact_topic_other: 'Other',
        contact_file: 'Attach a file (optional):',
        contact_file_hint: 'Formats: PNG, JPG, PDF, XLSX, CSV, TXT. Max 5 MB.',
        contact_file_type: 'File type not allowed.',
        contact_file_size: 'File exceeds the maximum size (5 MB).'
      }
    };

    const $ = (sel) => document.querySelectorAll(sel);
    function setLang(lang){
      const d = dict[lang];
      $('[data-i18n]').forEach(el=>{ const k = el.getAttribute('data-i18n'); if(d[k]) el.innerHTML = d[k]; });
      document.documentElement.lang = lang;
      document.getElementById('btn-es').classList.toggle('active', lang==='es');
      document.getElementById('btn-en').classList.toggle('active', lang==='en');
    }

    document.getElementById('btn-es').addEventListener('click', ()=> setLang('es'));
    document.getElementById('btn-en').addEventListener('click', ()=> setLang('en'));

    const pref = (navigator.language||'en').toLowerCase().startsWith('es') ? 'es' : 'en';
    setLang(pref);

    // ===== Contact form logic =====
    const tr = () => {
      const lang = document.documentElement.lang || 'en';
      const d = dict[lang] || dict.en;
      return {
        sending: d.contact_sending || 'Sending‚Ä¶',
        success: d.contact_success || 'Thanks! Your message has been sent.',
        error: d.contact_error || 'Something went wrong. Please try again later.',
        file_type: d.contact_file_type || 'File type not allowed.',
        file_size: d.contact_file_size || 'File exceeds the maximum size (5 MB).'
      };
    };

    const form = document.getElementById('contact-form');
    const statusEl = document.getElementById('form-status');
    const topicEl = document.getElementById('topic');
    const subjectEl = document.getElementById('subject');
    const fileEl = document.getElementById('file');

    function updateSubject() {
      const topic = topicEl?.value || '';
      subjectEl.value = topic ? `[${topic}] Consulta desde PREDWEEM` : 'Consulta desde PREDWEEM';
    }
    topicEl?.addEventListener('change', updateSubject);

    function validateFile() {
      if (!fileEl || !fileEl.files || fileEl.files.length === 0) return true;
      const file = fileEl.files[0];
      const maxBytes = 5 * 1024 * 1024; // 5 MB
      const allowed = [
        'image/png','image/jpeg','application/pdf',
        'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
        'text/csv','text/plain','application/csv'
      ];
      if (file.size > maxBytes) {
        statusEl.textContent = tr().file_size; return false;
      }
      if (!allowed.includes(file.type)) {
        statusEl.textContent = tr().file_type; return false;
      }
      statusEl.textContent = ''; return true;
    }
    fileEl?.addEventListener('change', validateFile);

    if (form) {
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        if (!validateFile()) return;

        updateSubject();
        statusEl.textContent = tr().sending;
        const btn = form.querySelector('button[type="submit"]');
        btn.disabled = true;

        try {
          const data = new FormData(form);
          const res = await fetch(form.action, {
            method: 'POST',
            body: data,
            headers: { 'Accept': 'application/json' }
          });
          if (res.ok) {
            form.reset();
            statusEl.textContent = tr().success;
          } else {
            statusEl.textContent = tr().error;
          }
        } catch {
          statusEl.textContent = tr().error;
        } finally {
          btn.disabled = false;
        }
      });
    }
  </script>
</body>
</html>

